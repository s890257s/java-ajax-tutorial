# ç« ç¯€ 2 ï½œ å‰ç«¯å·¥ç¨‹å¸«çš„æ­¦å™¨åº« (Modern Frontend)

## <a id="toc"></a>ç›®éŒ„

- [2-1 JavaScript ES6+ å¿…å‚™èªæ³•é€Ÿæˆ](#CH2-1)
- [2-2 éåŒæ­¥è™•ç† (Asynchronous)](#CH2-2)
- [2-3 HTTP Client çš„é¸æ“‡ï¼šXHR vs Fetch vs Axios](#CH2-3)

---

### åº

æ­¡è¿ä¾†åˆ°ç¬¬äºŒç« ã€‚

æ—©æœŸçš„ JS (ES6 ä»¥å‰) èªæ³•é¬†æ•£ï¼Œä½†è‡ªå¾ 2015 å¹´ ES6 (ECMAScript 2015) ç™¼å¸ƒå¾Œï¼ŒJS è®Šå¾—è¶Šä¾†è¶Šåƒä¸€é–€æˆç†Ÿçš„èªè¨€ã€‚

åœ¨é–‹å§‹å¯« Ajax ä¹‹å‰ï¼Œæˆ‘å€‘è¦å…ˆå‡ç´šä½ çš„æ­¦å™¨åº«ã€‚é€™ä¸€ç« æœƒå¸¶ä½ èªè­˜ç¾ä»£å‰ç«¯é–‹ç™¼å¿…å‚™çš„èªæ³•ç³–èˆ‡å·¥å…·ã€‚

> ğŸ’¡ å°çŸ¥è­˜ï¼šECMAScript èˆ‡ JavaScript çš„é—œä¿‚
>
> ECMAScript (ES) æ˜¯ JavaScript çš„ã€Œèªè¨€è¦æ ¼æ›¸ (Specification)ã€ï¼Œå®šç¾©äº†èªæ³•èˆ‡æ ¸å¿ƒè¡Œç‚ºã€‚
> JavaScript (JS) å‰‡æ˜¯ç›®å‰æœ€ä¸»æµã€æœ€å»£æ³›ä½¿ç”¨çš„ ECMAScript å¯¦ä½œ (Implementation)ã€‚

---

## <a id="CH2-1"></a>[2-1 JavaScript ES6+ å¿…å‚™èªæ³•é€Ÿæˆ](#toc)

### 1. è®Šæ•¸å®£å‘Šï¼š`const` vs `let`

ES6 ä»¥å‰æˆ‘å€‘ä½¿ç”¨ `var`ï¼Œä½†å®ƒæœ‰å¥‡æ€ªçš„ä½œç”¨åŸŸå•é¡Œã€å®¹æ˜“ç”¢ç”Ÿå„ç¨® BUGï¼Œç¾åœ¨è«‹ç›´æ¥ç„¡è¦–å®ƒã€‚
ç¾ä»£é–‹ç™¼è«‹éµå®ˆé€™æ¢é»ƒé‡‘æ³•å‰‡ï¼š**ã€Œèƒ½ç”¨ `const` å°±ç”¨ `const`ï¼ŒçœŸçš„è¦æ”¹è®Šæ‰ç”¨ `let`ã€**ã€‚

- **`const` (å¸¸æ•¸) - é è¨­é¦–é¸**

  - **æ„ç¾©**ï¼šä»£è¡¨é€™å€‹è®Šæ•¸çš„**ç¶å®š (Binding)** ä¸æœƒè¢«é‡æ–°æŒ‡æ´¾ã€‚
  - **å¥½è™•**ï¼š
    1.  **å®‰å…¨**ï¼šé¿å…è®Šæ•¸è¢«æ„å¤–è¦†å¯« (ä¾‹å¦‚ä¸å°å¿ƒæŠŠ `apiUrl` æ”¹æˆåˆ¥çš„å­—ä¸²)ã€‚
    2.  **å¯è®€æ€§**ï¼šçœ‹åˆ° `const` å°±çŸ¥é“ï¼Œé€™å€‹è®Šæ•¸åœ¨å‡½å¼å¾Œé¢ä¸æœƒè®Šæˆåˆ¥çš„æ±è¥¿ã€‚
  - **æ³¨æ„**ï¼šå¦‚æœæ˜¯ç‰©ä»¶/é™£åˆ—ï¼Œ`const` ä¿è­·çš„æ˜¯ã€Œè®Šæ•¸ä¸èƒ½é‡æ–°æŒ‡æ´¾ã€ï¼Œä½†ã€Œå…§å®¹ã€æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚

- **`let` (è®Šæ•¸)**
  - åªæœ‰åœ¨çœŸçš„éœ€è¦**é‡æ–°è³¦å€¼**æ™‚æ‰ä½¿ç”¨ï¼Œä¾‹å¦‚ `for` è¿´åœˆçš„ `i`ï¼Œæˆ–ç‹€æ…‹åˆ‡æ› (`isLoading` false -> true)ã€‚

```javascript
// 1. const ä¿è­·è®Šæ•¸ä¸è¢«é‡æ–°è³¦å€¼
const API_URL = "http://localhost:8080";
// API_URL = "abc"; // âŒ Error! æ•‘ä½ ä¸€å‘½

// 2. ä½†ç‰©ä»¶å…§å®¹æ˜¯å¯ä»¥æ”¹çš„
const user = { name: "Alice" };
user.name = "Bob"; // âœ… OK! åªæ˜¯æ”¹å…§å®¹ï¼Œè¨˜æ†¶é«”ä½å€æ²’è®Š

// 3. çœŸçš„è¦è®Šæ‰ç”¨ let
let count = 0;
count++; // âœ… OK!
```

> **ğŸ’¡ å‚™è¨»ï¼šç‚ºä»€éº¼ä½¿ç”¨ `const` æ˜¯ç¾ä»£é–‹ç™¼è¶¨å‹¢ï¼Ÿ**
>
> 1.  **é™ä½ã€Œæ„å¤–è¢«æ”¹æ‰ã€çš„é¢¨éšª (é€™è¶…é‡è¦)**
>
>     ```javascript
>     const apiUrl = "/api/users";
>     // ... ç¶“é 500 è¡Œ ...
>     apiUrl = "/api/admin"; // âŒ ç›´æ¥å ±éŒ¯ï¼Œæ•‘ä½ ä¸€å‘½ã€‚
>     ```
>
> 2.  **ç¨‹å¼ç¢¼ä¸€çœ¼å°±çŸ¥é“ã€Œæœƒä¸æœƒè®Šã€**
>
>     ```javascript
>     const users = fetchUsers(); // é€™æ˜¯è³‡æ–™ä¾†æºï¼Œä¸æœƒæ”¹è®Šã€‚
>     let selectedUser = null; // é€™æ˜¯äº’å‹•ç‹€æ…‹ï¼Œæœƒæ”¹è®Šã€‚
>     ```
>
>     å…‰çœ‹é—œéµå­—ï¼Œå¯è®€æ€§ç›´æ¥ +1 ç­‰ç´šã€‚
>
> 3.  **è·Ÿç¾ä»£æ¡†æ¶ (React/Vue) å¾ˆåˆæ‹**
>
>     ç¾ä»£å‰ç«¯æ›´å–œæ­¡ä½¿ç”¨ä»¥ä¸‹å¯«æ³•
>
>     ```javascript
>     const newList = oldList.map(...); // å»ºç«‹æ–°é™£åˆ—ï¼Œä¿ç•™åŸå§‹è³‡æ–™
>     ```
>
>     è€Œä¸æ˜¯
>
>     ```javascript
>     list.push(...); // ç›´æ¥ä¿®æ”¹åŸå§‹è³‡æ–™
>     ```
>
>     const åœ¨é€™è£¡å°±æ˜¯åœ¨å¹«ä½ ã€Œç”¨èªè¨€å±¤é¢æé†’è‡ªå·±ã€ï¼šåˆ¥å·å·ä¿®æ”¹åŸè³‡æ–™

### 2. ç®­é ­å‡½å¼ (Arrow Functions)

Java çš„ Lambda æ˜¯å­¸ JS çš„ã€‚é€™ä¸åªæ˜¯èªæ³•ç³–ï¼Œé‚„è§£æ±ºäº† `this` æŒ‡å‘æ··äº‚çš„å•é¡Œã€‚

```javascript
// å‚³çµ±å‡½å¼
function add(a, b) {
  return a + b;
}

// ç®­é ­å‡½å¼
const add = (a, b) => a + b; // é€£ return éƒ½å¯ä»¥çœç•¥

// æ‡‰ç”¨åœ¨ Ajax Callback
fetch(url).then((response) => response.json());
```

> **ğŸ’¡ é€²éšè§€å¿µï¼šé—œæ–¼ `this` çš„æŒ‡å‘**
>
> ç®­é ­å‡½å¼æ²’æœ‰è‡ªå·±çš„ `this`ï¼Œå®ƒæœƒ**ç¹¼æ‰¿å¤–å±¤å®£å‘Šæ™‚**çš„ `this`ã€‚
> é€™åœ¨æ’°å¯«ç‰©ä»¶æ–¹æ³•æˆ– Ajax Callback æ™‚è¦ç‰¹åˆ¥æ³¨æ„ï¼š
>
> - å¦‚æœä½ éœ€è¦ `this` æŒ‡å‘ç‰©ä»¶æœ¬èº«ï¼ˆä¾‹å¦‚ç‰©ä»¶çš„æ–¹æ³•ï¼‰ï¼Œè«‹ç”¨**å‚³çµ±å‡½å¼**ã€‚
> - å¦‚æœä½ æ˜¯åœ¨ç‰©ä»¶æ–¹æ³•å…§å‘¼å« Ajaxï¼Œæƒ³è¦åœ¨ Callback å…§ä½¿ç”¨ç‰©ä»¶çš„å±¬æ€§ï¼Œè«‹ç”¨**ç®­é ­å‡½å¼**ï¼ˆè®“ `this` ç¶­æŒæŒ‡å‘ç‰©ä»¶ï¼‰ã€‚
>
> ```javascript
> const user = {
>   name: "Alice",
>
>   // 1. å‚³çµ±å‡½å¼ï¼šthis æŒ‡å‘å‘¼å«è€… (user)
>   sayHi: function () {
>     console.log("Hi, I am " + this.name);
>   },
>
>   // 2. ç®­é ­å‡½å¼ï¼šthis ç¹¼æ‰¿è‡ªå¤–å±¤ (Window)ï¼Œç„¡æ³•æŒ‡å‘ user ç‰©ä»¶
>   sayHiArrow: () => {
>     console.log("Hi, I am " + this.name); // undefined
>   },
>
>   // 3. å¯¦æˆ°æ‡‰ç”¨ï¼šåœ¨ Callback ä¸­ä½¿ç”¨ç®­é ­å‡½å¼
>   testAsync: function () {
>     setTimeout(() => {
>       // âœ… æ­£ç¢ºï¼šç®­é ­å‡½å¼æœƒä¿ç•™å¤–å±¤ (testAsync) çš„ this (å³ user)
>       console.log("Async: I am " + this.name);
>     }, 100);
>
>     setTimeout(function () {
>       // âŒ éŒ¯èª¤ï¼šå‚³çµ± callback çš„ this æœƒæŒ‡å‘ Window
>       console.log("Async: I am " + this.name);
>     }, 100);
>   },
> };
> ```

### 3. Template æ¨¡æ¿å­—ä¸² (Template Literals)

åˆ¥å†ç”¨ `+` è™Ÿæ‹¼æ¹Š HTML å­—ä¸²äº†ï¼Œæ—¢ä¸ç¾è§€åˆå®¹æ˜“å‡ºéŒ¯ã€‚

```javascript
const name = "Alice";
const age = 30;

// å‚³çµ±å¯«æ³• (ä½¿ç”¨ + è™Ÿæ‹¼æ¥)
const oldHtml =
  '<div class="card">' +
  "<h1>" +
  name +
  "</h1>" +
  "<p>Age: " +
  age +
  "</p>" +
  "</div>";

// åå¼•è™Ÿ (Backticks) ` `
const html = `
    <div class="card">
        <h1>${name}</h1>
        <p>Age: ${age}</p>
    </div>
`;
```

### 4. è§£æ§‹è³¦å€¼ (Destructuring Assignment)

å¾ç‰©ä»¶æˆ–é™£åˆ—ä¸­å¿«é€Ÿæå–è³‡æ–™ã€‚é€™åœ¨è™•ç† Ajax å›å‚³çš„ JSON æ™‚è¶…ç´šå¥½ç”¨ã€‚

```javascript
const user = {
  id: 1,
  username: "Alice",
  email: "Alice@example.com",
  address: { city: "Taipei" },
};

// å‚³çµ±å¯«æ³•
const name = user.username;

// åŸºæœ¬è§£æ§‹
const { username, email } = user;
console.log(username); // Alice
console.log(email); // Alice@example.com

// é€²éšï¼šå¤šå±¤è§£æ§‹
const {
  address: { city },
} = user;
console.log(city); // Taipei
```

### 5. å±•é–‹é‹ç®—å­ (Spread Operator)

ä½¿ç”¨ `...` ç¬¦è™Ÿï¼Œå¯ä»¥å¿«é€Ÿå±•é–‹é™£åˆ—æˆ–ç‰©ä»¶ï¼Œå¸¸ç”¨æ–¼è¤‡è£½æˆ–åˆä½µè³‡æ–™ã€‚

```javascript
// é™£åˆ—å±•é–‹
const arr1 = [1, 2, 3];
const arr2 = [...arr1, 4, 5]; // [1, 2, 3, 4, 5]

// ç‰©ä»¶å±•é–‹ (æ·ºæ‹·è²)
const user = { name: "Alice", age: 25 };
const updatedUser = { ...user, age: 26, city: "Taipei" };
// { name: "Alice", age: 26, city: "Taipei" }
```

**æ³¨æ„ï¼šå±•é–‹é‹ç®—å­åƒ…ç‚ºã€Œæ·ºæ‹·è² (Shallow Copy)ã€**
è‹¥ç‰©ä»¶å…§åŒ…å«å·¢ç‹€ç‰©ä»¶ï¼ˆä¾‹å¦‚ `address`ï¼‰ï¼Œå±•é–‹é‹ç®—å­åªæœƒè¤‡è£½åƒç…§ã€‚ä¿®æ”¹æ–°ç‰©ä»¶çš„å±¬æ€§æœƒå½±éŸ¿åŸç‰©ä»¶ã€‚

è‹¥éœ€**æ·±å±¤æ‹·è² (Deep Copy)**ï¼Œæœ€ç°¡å–®çš„æ–¹å¼æ˜¯ä½¿ç”¨ `JSON` æ–¹æ³•ï¼š

```javascript
const user = { name: "Alice", address: { city: "å°åŒ—å¸‚" } };
const deepCopiedUser = JSON.parse(JSON.stringify(user));

deepCopiedUser.address.city = "å°ä¸­å¸‚";
console.log(user.address.city); // å°åŒ—å¸‚ (ä¸å—å½±éŸ¿)
```

### 6. å¸¸ç”¨é™£åˆ—æ–¹æ³•

ç¾ä»£ JS è™•ç†è³‡æ–™æµçš„æ ¸å¿ƒï¼Œå‘Šåˆ¥å‚³çµ± `for` è¿´åœˆã€‚é€™äº›æ–¹æ³•å¤§éƒ¨åˆ†**ä¸æœƒæ”¹è®ŠåŸé™£åˆ—**ï¼Œè€Œæ˜¯å›å‚³æ–°çµæœã€‚

#### Transformation (è½‰æ›)

- **`map()`**ï¼šå°‡é™£åˆ—ä¸­çš„æ¯å€‹å…ƒç´ è½‰æ›æˆæ–°å…ƒç´ ã€‚
  ```javascript
  const nums = [1, 2, 3];
  const doubled = nums.map((n) => n * 2); // [2, 4, 6]
  ```
- **`reduce()`**ï¼šå°‡é™£åˆ—æ­¸ç´ç‚ºå–®ä¸€å€¼ (ä¾‹å¦‚åŠ ç¸½)ã€‚

  åŠŸèƒ½æœ€å¼·å¤§çš„é™£åˆ—æ–¹æ³•(ç¨å¾®è¤‡é›œ)ï¼Œèƒ½å°‡é™£åˆ—å…ƒç´ ç¶“ç”±å›å‘¼å‡½å¼é‹ç®—ï¼Œæœ€çµ‚åŒ–ç‚ºã€Œå–®ä¸€å€¼ã€ï¼ˆå¯èƒ½æ˜¯æ•¸å­—ã€ç‰©ä»¶æˆ–é™£åˆ—ï¼‰ã€‚

  **èªæ³•çµæ§‹ï¼š**
  `array.reduce((acc, curr) => { ... }, initialValue)`

  - `acc` (accumulator): ç´¯åŠ å€¼ï¼Œå³ä¸Šä¸€æ¬¡å›å‘¼å‡½å¼çš„å›å‚³å€¼ã€‚
  - `curr` (current): ç•¶å‰è™•ç†çš„å…ƒç´ ã€‚
  - `initialValue`: ç´¯åŠ å€¼çš„åˆå§‹è¨­å®šï¼ˆé¸å¡«ï¼Œä½†å»ºè­°åŠ ä¸Šï¼‰ã€‚

  ```javascript
  const numbers = [1, 2, 3, 4];
  const sum = numbers.reduce((acc, curr) => {
    return acc + curr;
  }, 0);
  // åˆå§‹å€¼ 0ï¼Œä¾åºåŠ  1, 2, 3, 4 => çµæœ 10
  ```

#### Filtering & Finding (éæ¿¾èˆ‡å°‹æ‰¾)

- **`filter()`**ï¼šä¿ç•™ç¬¦åˆæ¢ä»¶çš„å…ƒç´ ã€‚
  ```javascript
  const evens = nums.filter((n) => n % 2 === 0); // [2]
  ```
- **`find()`**ï¼šå›å‚³**ç¬¬ä¸€å€‹**ç¬¦åˆæ¢ä»¶çš„å…ƒç´ ã€‚
  ```javascript
  const found = nums.find((n) => n > 1); // 2
  ```
- **`slice()`**ï¼šå›å‚³é™£åˆ—çš„ä¸€éƒ¨åˆ† (åˆ‡ç‰‡)ã€‚
  ```javascript
  const parts = nums.slice(0, 2); // [1, 2] (ä¸åŒ…å« index 2)
  ```

#### Checking (æª¢æŸ¥)

- **`includes()`**ï¼šæª¢æŸ¥é™£åˆ—æ˜¯å¦åŒ…å«æŸå€‹å€¼ã€‚
  ```javascript
  nums.includes(2); // true
  ```
- **`some()`**ï¼šæª¢æŸ¥æ˜¯å¦æœ‰**è‡³å°‘ä¸€å€‹**å…ƒç´ ç¬¦åˆæ¢ä»¶ã€‚
  ```javascript
  nums.some((n) => n > 2); // true
  ```
- **`every()`**ï¼šæª¢æŸ¥æ˜¯å¦**æ‰€æœ‰**å…ƒç´ éƒ½ç¬¦åˆæ¢ä»¶ã€‚
  ```javascript
  nums.every((n) => n > 0); // true
  ```

### 7. æ¨¡çµ„åŒ– (Modules)

å°‡ç¨‹å¼æ‹†åˆ†æˆå°æª”æ¡ˆï¼Œæ˜“æ–¼ç¶­è­·èˆ‡é‡ç”¨ã€‚ä½¿ç”¨ `export` åŒ¯å‡ºï¼Œ`import` åŒ¯å…¥ã€‚
(æ³¨æ„ï¼šåœ¨ç€è¦½å™¨ç›´æ¥ä½¿ç”¨éœ€è¦å®£å‘Š `<script type="module">`ï¼Œé€šå¸¸æœƒæ­é… Webpack/Vite ç­‰å·¥å…·æ‰“åŒ…)

**å…·ååŒ¯å‡º (Named Export)ï¼š**
å¯ä»¥åŒ¯å‡ºå¤šå€‹è®Šæ•¸æˆ–å‡½å¼ã€‚éœ€ä½¿ç”¨ `{}` æ¥æ”¶ã€‚

```javascript
// math.js
export const add = (a, b) => a + b;
export const pi = 3.14;
```

**åŒ¯å…¥å…·åæˆå“¡ï¼š**
éœ€ä½¿ç”¨ `{}` ä¸”åç¨±éœ€å°æ‡‰ï¼ˆæˆ–ä½¿ç”¨ `as` é‡æ–°å‘½åï¼‰ã€‚

```javascript
import { add, pi } from "./math.js";
console.log(add(1, 2)); // 3
```

**é è¨­åŒ¯å‡º (Default Export)ï¼š**
æ¯å€‹æª”æ¡ˆåªèƒ½æœ‰ä¸€å€‹é è¨­åŒ¯å‡ºï¼Œé€šå¸¸ç”¨æ–¼åŒ¯å‡ºå…ƒä»¶æˆ–ä¸»è¦åŠŸèƒ½ã€‚ä¸éœ€ `{}` æ¥æ”¶ã€‚

```javascript
// user.js
const user = { name: "Alice" };
export default user;
```

**åŒ¯å…¥é è¨­æˆå“¡ï¼š**
ä¸éœ€ `{}`ï¼Œä¸”å¯ä»¥è‡ªè¨‚åç¨±ã€‚

```javascript
import currentUser from "./user.js";
```

---

## <a id="CH2-2"></a>[2-2 éåŒæ­¥è™•ç† (Asynchronous)](#toc)

### 1. æ¦‚å¿µ (Concept)

JavaScript æ˜¯**å–®åŸ·è¡Œç·’ (Single Threaded)** çš„èªè¨€ï¼Œé€™æ„å‘³è‘—å®ƒä¸€æ¬¡åªèƒ½åšä¸€ä»¶äº‹ã€‚
å¦‚æœåŸ·è¡Œä¸€å€‹è€—æ™‚æ“ä½œï¼ˆä¾‹å¦‚ï¼šè·Ÿä¼ºæœå™¨è¦è³‡æ–™éœ€è¦ 3 ç§’ï¼‰ï¼Œä¸»ç¨‹å¼å°±æœƒè¢«å¡ä½ (Blocking)ï¼Œå°è‡´ç•«é¢å‡çµï¼Œä½¿ç”¨è€…é«”é©—æ¥µå·®ã€‚

**éåŒæ­¥ (Asynchronous)** å°±æ˜¯è§£æ±ºæ–¹æ¡ˆï¼šæŠŠè€—æ™‚çš„ä»»å‹™äº¤çµ¦ç€è¦½å™¨èƒŒæ™¯è™•ç†ï¼Œä¸»ç¨‹å¼ç¹¼çºŒå¾€ä¸‹è·‘ï¼Œç­‰ä»»å‹™å¥½äº†å†å›ä¾†é€šçŸ¥æˆ‘ã€‚

> **ğŸ’¡ å‚™è¨»: é—œæ–¼ç€è¦½å™¨ä¸­ JavaScript çš„é‹è¡Œæ©Ÿåˆ¶ (æ­¤ä¸è¨è«– node.js)**
> JavaScript åœ¨ç€è¦½å™¨ä¸­é‹è¡Œæ™‚ï¼Œåªæœ‰ä¸€æ¢ä¸»è¦åŸ·è¡Œç·’ï¼Œä¸¦ä¾å¾ªã€Œè§£æ â†’ åŸ·è¡Œã€çš„é †åºè™•ç†ç¨‹å¼ç¢¼ï¼›ä¹Ÿå› æ­¤ï¼ŒJS åœ¨åŒä¸€æ™‚é–“åªèƒ½é€²è¡Œä¸€é …ä»»å‹™ã€‚
> ç•¶é‡åˆ°è€—æ™‚æˆ–è¤‡é›œçš„å·¥ä½œæ™‚ï¼ŒJS æœƒå°‡é€™äº›ä»»å‹™äº¤ç”±ç€è¦½å™¨è™•ç†ï¼Œé¿å…é˜»å¡ä¸»åŸ·è¡Œç·’ï¼Œç¢ºä¿ç•«é¢èˆ‡æ“ä½œä»ç¶­æŒé †æš¢ã€‚
> ç€è¦½å™¨æœ¬èº«æ“æœ‰å¤šæ¢å°ˆè²¬åŸ·è¡Œç·’ï¼Œä¾‹å¦‚ï¼š
>
> - Timer Threadï¼šè² è²¬ç®¡ç† setTimeoutã€setInterval
> - Network Threadï¼šè™•ç† AJAXã€fetch ç­‰ç¶²è·¯è«‹æ±‚
> - I/O Threadï¼šè² è²¬ DOM äº‹ä»¶ã€æª”æ¡ˆè®€å–ç­‰è¼¸å…¥è¼¸å‡ºæ“ä½œ
> - Rendering Threadï¼šæŒæ§ç•«é¢æ’ç‰ˆèˆ‡é‡æ–°ç¹ªè£½
> - Web Worker Threadï¼šæä¾›çœŸæ­£ç¨ç«‹çš„ JS åŸ·è¡Œç·’ï¼Œå°ˆé–€è™•ç†å¤§é‡è¨ˆç®—ï¼›èˆ‡ä¸»åŸ·è¡Œç·’å®Œå…¨éš”é›¢ï¼Œç„¡æ³•æ“ä½œ DOMï¼Œä¹Ÿä¸å…·å‚™ window ç‰©ä»¶ã€‚
>
> æ¨¡æ“¬è¡Œç‚ºå¯åƒè€ƒ https://www.jsv9000.app/

### 2. å›å‘¼åœ°ç„ (Callback Hell)ï¼Œä»¥ä¸‹ç‚ºæ¼”ç¤ºç¨‹å¼ç¢¼ï¼Œæ­¤å¯«æ³•å·²è¢«æ·˜æ±°

éåŒæ­¥ä»»å‹™ï¼ˆå¦‚ `fetch`ã€`setTimeout`ï¼‰é›–ç„¶æœƒä¾ç…§ç¨‹å¼ç¢¼é †åº**é€è¡Œå•Ÿå‹•**ï¼Œä½†å•Ÿå‹•å¾Œæœƒäº¤ç”±ç€è¦½å™¨åœ¨èƒŒæ™¯è™•ç†ï¼Œ**å®Œæˆæ™‚é–“ä¸å›ºå®š**  
ä»¥ä¸‹å¯«æ³•**ç„¡æ³•ä¿è­‰åŸ·è¡Œçµæœçš„é †åº**ï¼Œè‹¥æœ‰è³‡æ–™ä¾è³´é—œä¿‚ï¼Œå°‡æœƒå°è‡´åš´é‡çš„é‚è¼¯éŒ¯èª¤ã€‚

```javascript
// éš¨æ©Ÿå–å¾—å»¶é²æ™‚é–“ 0~999 æ¯«ç§’
const getRandomDelay = () => Math.floor(Math.random() * 1000);

// æ¨¡æ“¬éåŒæ­¥æ“ä½œ
const asyncProcess = (str) => {
  setTimeout(() => {
    console.log("åŸ·è¡Œæ“ä½œ: " + str);
  }, getRandomDelay());
};

// åŸ·è¡ŒéåŒæ­¥æ“ä½œï¼Œå®Œæˆæ™‚é–“ä¸å›ºå®šï¼Œç„¡æ³•ä¿è­‰é †åºï¼Œæœƒå°è‡´åš´é‡çš„é‚è¼¯éŒ¯èª¤ã€‚
asyncProcess("1. å–å¾—ä½¿ç”¨è€…...");
asyncProcess("2. æ ¹æ“šä½¿ç”¨è€…å–å¾—è¨‚å–®...");
asyncProcess("3. æ ¹æ“šè¨‚å–®å–å¾—å•†å“ç¸½æ•¸...");
asyncProcess("4. æ ¹æ“šå•†å“ç¸½æ•¸è¨ˆç®—ç¸½åƒ¹...");
asyncProcess("5. é¡¯ç¤ºç¸½åƒ¹...");
```

æˆ‘å€‘ç¾åœ¨æŠŠåŸæ–¹æ³• `asyncProcess(str)`ï¼Œæ”¹ç‚º `asyncProcess(str, successCallback)`ã€‚
ä¹Ÿå°±æ˜¯èªªï¼Œç•¶ asyncProcess åŸ·è¡ŒæˆåŠŸå¾Œï¼Œæœƒä¸»å‹•å‘¼å« successCallbackã€‚

```javascript
// æŠŠã€Œæ–¹æ³•ã€ç•¶æˆåƒæ•¸å‚³å…¥ asyncProcessï¼ŒasyncProcess åŸ·è¡ŒæˆåŠŸå¾Œï¼Œæœƒä¸»å‹•å‘¼å«(å³æ˜¯ callback function)ã€‚
const asyncProcess = (str, successCallback) => {
  setTimeout(() => {
    console.log("åŸ·è¡Œæ“ä½œ: " + str);
    successCallback(); // ä¸»å‹•åŸ·è¡Œä¸‹ä¸€å€‹æ–¹æ³•
  }, getRandomDelay());
};

// é€æ­¥åŸ·è¡ŒéåŒæ­¥æ“ä½œ
asyncProcess("1. å–å¾—ä½¿ç”¨è€…...", () => {
  asyncProcess("2. æ ¹æ“šä½¿ç”¨è€…å–å¾—è¨‚å–®...", () => {
    // ä¾åºä¸²æ¥...
  });
});
```

ä½†åŸ·è¡ŒéåŒæ­¥æ“ä½œï¼Œä¸èƒ½ä¿è­‰ä¸€å®šæœƒæˆåŠŸï¼Œæ‡‰è¦è€ƒæ…®å¤±æ•—æ™‚è©²åŸ·è¡Œçš„ç¨‹å¼ã€‚
æ•…åœ¨åŸæ–¹æ³•ä¸­åŠ å…¥éŒ¯èª¤è™•ç†ï¼Œæ–¹æ³•æœƒè®Šæˆ `asyncProcess(str, successCallback, errorCallback)`ã€‚

```javascript
// è£œä¸ŠéŒ¯èª¤è™•ç†ï¼Œæ­¤ç¯„ä¾‹ä½¿ç”¨éš¨æ©Ÿæ•¸æ±ºå®šæˆæ•—ï¼ŒçœŸå¯¦ç¨‹å¼æœƒæœ‰æ˜ç¢ºçš„éŒ¯èª¤è™•ç†åˆ¤æ–·
const asyncProcess = (str, successCallback, errorCallback) => {
  setTimeout(() => {
    console.log("åŸ·è¡Œæ“ä½œ: " + str);

    // æˆåŠŸç‡ 90%
    if (Math.random() <= 0.9) {
      successCallback(); // æˆåŠŸåŸ·è¡Œ
    } else {
      errorCallback(); // å¤±æ•—åŸ·è¡Œ
    }
  }, getRandomDelay());
};

// å®Œæ•´å¯«æ³•ï¼ŒCallback Hellï¼Œå›å‘¼åœ°ç„ï¼›é›£ä»¥ç¶­è­·ã€é›£ä»¥é–±è®€ï¼Œä¹Ÿæœ‰ã€Œæ³¢å‹•æ‹³ Hadoukenã€çš„åˆ¥ç¨±ã€‚
asyncProcess(
  "1. å–å¾—ä½¿ç”¨è€…...",
  () => {
    asyncProcess(
      "2. æ ¹æ“šä½¿ç”¨è€…å–å¾—è¨‚å–®...",
      () => {
        asyncProcess(
          "3. æ ¹æ“šè¨‚å–®å–å¾—å•†å“ç¸½æ•¸...",
          () => {
            asyncProcess(
              "4. æ ¹æ“šå•†å“ç¸½æ•¸è¨ˆç®—ç¸½åƒ¹...",
              () => {
                asyncProcess(
                  "5. é¡¯ç¤ºç¸½åƒ¹...",
                  () => {
                    console.log("å…¨éƒ¨å®Œæˆ Success!");
                  },
                  () => console.log("å¤±æ•—: 5")
                );
              },
              () => console.log("å¤±æ•—: 4")
            );
          },
          () => console.log("å¤±æ•—: 3")
        );
      },
      () => console.log("å¤±æ•—: 2")
    );
  },
  () => console.log("å¤±æ•—: 1")
);
```

<div style="display: flex; justify-content: center;">
  <img src="./images/Hadouken.webp" width="300" style="border-radius: 10px;">
</div>
<p align="center"><i>Callback Hell åˆè¢«æˆ²ç¨±ç‚ºæ³¢å‹•æ‹³ (Hadouken)</i></p>

### 3. Promise

ES6 å¼•å…¥äº† Promise (æ‰¿è«¾)ï¼Œé€™æ˜¯ç¾ä»£éåŒæ­¥é–‹ç™¼çš„åŸºçŸ³ã€‚ç°¡å–®ä¾†èªªï¼Œå®ƒå°‡éåŒæ­¥æ“ä½œæ¨™æº–åŒ–ç‚ºä¸€å€‹ç‰©ä»¶ï¼Œè®“ä½ ç”¨æ›´å„ªé›…çš„æ–¹å¼è™•ç†ã€Œæœªä¾†æ‰æœƒç™¼ç”Ÿã€çš„äº‹ä»¶ã€‚

Promise æœ‰ä¸‰ç¨®ç‹€æ…‹ï¼š

1.  **Pending** (ç­‰å¾…ä¸­)ï¼šåˆå§‹ç‹€æ…‹ï¼Œæ“ä½œå°šæœªå®Œæˆã€‚
2.  **Fulfilled** (å·²å¯¦ç¾/æˆåŠŸ)ï¼šæ“ä½œæˆåŠŸå®Œæˆ -> è§¸ç™¼ `.then()`ã€‚
3.  **Rejected** (å·²æ‹’çµ•/å¤±æ•—)ï¼šæ“ä½œå¤±æ•— -> è§¸ç™¼ `.catch()`ã€‚

Promise æœ€ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯è§£æ±ºå›å‘¼åœ°ç„çš„ã€Œç¸®æ’ã€èˆ‡ã€ŒéŒ¯èª¤è™•ç†ã€å•é¡Œã€‚å®ƒå°‡å·¢ç‹€çµæ§‹æ”¹ç‚ºã€Œéˆå¼å‘¼å« (Chaining)ã€ï¼Œè®“ç¨‹å¼ç¢¼ç”±ä¸Šè€Œä¸‹ç·šæ€§åŸ·è¡Œï¼Œé–±è®€æ€§å¤§å¹…æå‡ã€‚

```javascript
// Promise åŸºæœ¬èªæ³•
const myPromise = new Promise((resolve, reject) => {
  // åŸ·è¡ŒéåŒæ­¥ä»»å‹™ (ä¾‹å¦‚ API è«‹æ±‚ã€è¨ˆæ™‚å™¨ç­‰)
  const isSuccess = true;

  if (isSuccess) {
    resolve("ä»»å‹™æˆåŠŸï¼é€™æ˜¯å›å‚³çš„è³‡æ–™"); // é€²å…¥ .then()
  } else {
    reject("ä»»å‹™å¤±æ•—...é€™æ˜¯éŒ¯èª¤è¨Šæ¯"); // é€²å…¥ .catch()
  }
});

// ä½¿ç”¨ Promise
myPromise
  .then((data) => {
    // æˆåŠŸæ™‚çš„è™•ç†é‚è¼¯
    console.log(data);
  })
  .catch((error) => {
    // å¤±æ•—æ™‚çš„è™•ç†é‚è¼¯
    console.error(error);
  })
  .finally(() => {
    // ç„¡è«–æˆåŠŸæˆ–å¤±æ•—ï¼Œæœ€å¾Œéƒ½æœƒåŸ·è¡Œçš„å€å¡Š (ä¾‹å¦‚ï¼šéš±è—è®€å–å‹•ç•«)
    console.log("ç¨‹åºçµæŸ");
  });
```

**ğŸ’» å¯¦æˆ°ï¼šè§£æ±º Callback Hell**

æˆ‘å€‘å°‡ä¸Šé¢ç¯„ä¾‹ä¸­çš„ `asyncProcess` æ”¹å¯«ç‚º Promise ç‰ˆæœ¬ï¼Œè«‹çœ‹å·®ç•°ï¼š

```javascript
// 1. å®šç¾©ï¼šå›å‚³ä¸€å€‹ Promise ç‰©ä»¶
const asyncProcess = (str) => {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      console.log("åŸ·è¡Œæ“ä½œ: " + str);

      // æ¨¡æ“¬æˆåŠŸèˆ‡å¤±æ•—
      if (Math.random() <= 0.9) {
        resolve(); // æˆåŠŸ -> å°æ‡‰ .then()
      } else {
        reject("åŸ·è¡Œå¤±æ•—: " + str); // å¤±æ•— -> å°æ‡‰ .catch()
      }
    }, getRandomDelay());
  });
};

// 2. å‘¼å«ï¼šå„ªé›…çš„éˆå¼ä¸²æ¥
asyncProcess("1. å–å¾—ä½¿ç”¨è€…...")
  .then(() => {
    // æ­¥é©Ÿ 1 æˆåŠŸå¾Œï¼Œå›å‚³ä¸‹ä¸€å€‹ Promise (æ­¥é©Ÿ 2)
    return asyncProcess("2. æ ¹æ“šä½¿ç”¨è€…å–å¾—è¨‚å–®...");
  })
  .then(() => asyncProcess("3. æ ¹æ“šè¨‚å–®å–å¾—å•†å“ç¸½æ•¸...")) // ç®­é ­å‡½å¼ç°¡å¯«
  .then(() => asyncProcess("4. æ ¹æ“šå•†å“ç¸½æ•¸è¨ˆç®—ç¸½åƒ¹..."))
  .then(() => asyncProcess("5. é¡¯ç¤ºç¸½åƒ¹..."))
  .then(() => console.log("å…¨éƒ¨å®Œæˆ Success!"))
  .catch((error) => {
    // âš ï¸ å¼·å¤§çš„éŒ¯èª¤è™•ç†ï¼šåªè¦ä¸­é–“ä»»ä½•ä¸€æ­¥é©Ÿå¤±æ•—ï¼Œå°±æœƒç›´æ¥è·³åˆ°é€™è£¡ï¼
    // ä¸ç”¨åƒ Callback æ¯ä¸€å±¤éƒ½è¦å¯«ä¸€æ¬¡éŒ¯èª¤è™•ç†ã€‚
    console.error("å—šå—šï¼Œæµç¨‹ä¸­æ–·äº†:", error);
  });
```

é€™æ¨£æ˜¯ä¸æ˜¯æ¸…çˆ½å¤šäº†ï¼Ÿè€Œä¸”åªè¦ä¸€å€‹ `.catch()` å°±èƒ½æ•ç²æ•´æ¢éˆä¸Šçš„éŒ¯èª¤ï¼

### 4. Async / Await

ES8 (2017) æ¨å‡ºçš„ `async` / `await` æ˜¯ Promise çš„èªæ³•ç³–ï¼Œä¹Ÿæ˜¯ç›®å‰**æœ€ä¸»æµã€æœ€æ¨è–¦**çš„å¯«æ³•ã€‚
å®ƒè®“éåŒæ­¥ç¨‹å¼ç¢¼è®€èµ·ä¾†è·Ÿã€ŒåŒæ­¥ç¨‹å¼ç¢¼ã€å¹¾ä¹ä¸€æ¨£ï¼Œä¸åƒ…ç›´è§€ï¼Œé‚„èƒ½ç›´æ¥ä½¿ç”¨ `try-catch` é€²è¡ŒéŒ¯èª¤è™•ç†ã€‚

- **`async`**ï¼šå°‡å‡½å¼æ¨™è¨˜ç‚ºéåŒæ­¥ï¼Œè©²å‡½å¼æœƒè‡ªå‹•å›å‚³ä¸€å€‹ Promiseã€‚
- **`await`**ï¼šåªèƒ½åœ¨ `async` å‡½å¼å…§ä½¿ç”¨ã€‚å®ƒæœƒæš«åœç¨‹å¼åŸ·è¡Œï¼Œç›´åˆ° Promise è§£æå®Œæˆä¸¦å›å‚³çµæœã€‚

**åŸºæœ¬èªæ³•çµæ§‹**

ä½¿ç”¨ `await` å¯ä»¥ç›´æ¥å°‡ Promise çš„è§£æçµæœ (Resolve Value) è³¦å€¼çµ¦è®Šæ•¸ï¼Œå°±åƒå¯«åŒæ­¥ç¨‹å¼ç¢¼ä¸€æ¨£ç›´è¦ºã€‚

```javascript
const getData = async () => {
  try {
    // await æœƒæš«åœä¸¦ç­‰å¾… Promise å®Œæˆï¼Œç„¶å¾Œå°‡çµæœå›å‚³çµ¦è®Šæ•¸
    const user = await fetchUser();
    console.log("å–å¾—ä½¿ç”¨è€…:", user);

    // æ¥çºŒåŸ·è¡Œä¸‹ä¸€å€‹éåŒæ­¥ä»»å‹™
    const orders = await fetchOrders(user.id);
    console.log("å–å¾—è¨‚å–®:", orders);
  } catch (error) {
    // çµ±ä¸€æ•æ‰éŒ¯èª¤ (åŒ…å« user æˆ– orders å¤±æ•—)
    console.error("ç™¼ç”ŸéŒ¯èª¤:", error);
  }
};
```

**ğŸ’» å¯¦æˆ°ï¼šç”¨ Async/Await æ”¹å¯« Promise éˆå¼å¯«æ³•**

æˆ‘å€‘å°‡ä¸Šé¢çš„ Promise éˆå¼å¯«æ³•ï¼Œæ”¹æˆ Async/Await ç‰ˆæœ¬ã€‚ä½ æœƒç™¼ç¾ï¼Œé‚£äº› `.then()` å…¨éƒ¨éƒ½ä¸è¦‹äº†ï¼Œç¨‹å¼ç¢¼è®Šå¾—éå¸¸ä¹¾æ·¨ï¼

```javascript
const asyncProcess = (str) => {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      console.log("åŸ·è¡Œæ“ä½œ: " + str);

      if (Math.random() <= 0.9) {
        resolve();
      } else {
        reject("åŸ·è¡Œå¤±æ•—: " + str);
      }
    }, getRandomDelay());
  });
};

// å»ºç«‹ä¸€å€‹ async å‡½å¼ä¾†ç®¡ç†æµç¨‹
const startFlow = async () => {
  try {
    console.log("ä»»å‹™é–‹å§‹...");

    // å°±åƒå¯«åŒæ­¥ç¨‹å¼ç¢¼ä¸€æ¨£ï¼Œä¸€è¡Œä¸€è¡Œå¾€ä¸‹åŸ·è¡Œ
    await asyncProcess("1. å–å¾—ä½¿ç”¨è€…...");
    await asyncProcess("2. æ ¹æ“šä½¿ç”¨è€…å–å¾—è¨‚å–®...");
    await asyncProcess("3. æ ¹æ“šè¨‚å–®å–å¾—å•†å“ç¸½æ•¸...");
    await asyncProcess("4. æ ¹æ“šå•†å“ç¸½æ•¸è¨ˆç®—ç¸½åƒ¹...");
    await asyncProcess("5. é¡¯ç¤ºç¸½åƒ¹...");

    console.log("å…¨éƒ¨å®Œæˆ Success!");
  } catch (error) {
    // åªè¦ä¸Šé¢ä»»ä½•ä¸€è¡Œå‡ºéŒ¯ï¼Œå°±æœƒç›´æ¥è·³åˆ°é€™è£¡
    console.error("å—šå—šï¼Œæµç¨‹ä¸­æ–·äº†:", error);
  }
};

// åŸ·è¡Œå‡½å¼
startFlow();
```

**æ¯”è¼ƒä¸€ä¸‹å·®ç•°ï¼š**

1.  **Callback**: å‘å³é•·èƒ– (æ³¢å‹•æ‹³)ï¼Œå·¢ç‹€åœ°ç„ã€‚
2.  **Promise**: å‘ä¸‹ç”Ÿé•·ï¼Œä½†é‚„æ˜¯è¦å¯«å¾ˆå¤š `.then()` è·Ÿå›å‘¼å‡½å¼ã€‚
3.  **Async/Await**: **ä¹¾æ·¨ä¿è½**ï¼Œå°±åƒåœ¨å¯«ä¸€èˆ¬åŒæ­¥çš„ç¨‹å¼ç¢¼ã€‚

---

## <a id="CH2-3"></a>[2-3 HTTP Client çš„é¸æ“‡ï¼šXHR vs Fetch vs Axios](#toc)

æŒæ¡äº† Async/Await éåŒæ­¥è™•ç†çš„æ¦‚å¿µå¾Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘è¦å¯¦éš›èˆ‡å¾Œç«¯ä¼ºæœå™¨é€²è¡Œæºé€šã€‚
åœ¨å‰ç«¯é–‹ç™¼ä¸­ï¼Œä¸»è¦æœ‰ä¸‰ç¨®ç™¼é€ HTTP è«‹æ±‚çš„æ–¹å¼ï¼Œè®“æˆ‘å€‘ä¾†çœ‹çœ‹å®ƒå€‘çš„æ¼”é€²èˆ‡ç‰¹æ€§ã€‚

### é¸æ‰‹ 1: XMLHttpRequest (XHR)

é€™æ˜¯æ—©æœŸçš„ AJAX å¯¦ä½œæ–¹å¼ï¼Œç¾åœ¨å·²ç¶“é®®å°‘ç›´æ¥ä½¿ç”¨ã€‚

- **å„ªé»**ï¼šç›¸å®¹æ€§æ¥µä½³ï¼ˆæ”¯æ´ IE6ï¼‰ã€‚
- **ç¼ºé»**ï¼š
  - èªæ³•ç¹ç‘£ï¼Œéœ€è™•ç†è¤‡é›œçš„ç‹€æ…‹ç¢¼ã€‚
  - å®¹æ˜“é™·å…¥ Callback Hellã€‚
  - ä¸æ”¯æ´ Promiseã€‚

**ç¨‹å¼ç¯„ä¾‹ï¼š**

```javascript
var xhr = new XMLHttpRequest();
xhr.open("GET", "http://localhost:8080/ch2_3/api/todo/1");

xhr.onreadystatechange = function () {
  if (xhr.readyState === 4) {
    // è«‹æ±‚å®Œæˆ
    if (xhr.status === 200) {
      // æˆåŠŸ
      console.log(JSON.parse(xhr.responseText));
    } else {
      console.error("å‡ºéŒ¯äº†");
    }
  }
};

xhr.send();
```

### é¸æ‰‹ 2: Fetch API

éš¨è‘— ES6 æ¨å‡ºçš„ç¾ä»£ç€è¦½å™¨å…§å»ºæ¨™æº–ã€‚

- **å„ªé»**ï¼šç€è¦½å™¨å…§å»ºï¼Œç„¡éœ€é¡å¤–å®‰è£ Libraryã€‚
- **ç¼ºé»**ï¼š
  - **éœ€æ‰‹å‹•è™•ç†éŒ¯èª¤**ï¼šHTTP 404 æˆ– 500 ä»æœƒè¦–ç‚ºã€ŒæˆåŠŸã€ï¼Œä¸æœƒè‡ªå‹•é€²å…¥ `catch`ï¼Œéœ€è‡ªè¡Œåˆ¤æ–· `response.ok`ã€‚
  - **éœ€æ‰‹å‹•è½‰æ› JSON**ï¼šéœ€å¤šä¸€é“ `.json()` çš„æ‰‹çºŒã€‚
  - **åŠŸèƒ½è¼ƒé™½æ˜¥**ï¼šä¸æ”¯æ´è«‹æ±‚é€¾æ™‚ (Timeout) è¨­å®šï¼ˆéœ€æ­é… AbortControllerï¼‰ã€ç„¡å…§å»ºæ””æˆªå™¨ (Interceptors)ã€‚

**ç¨‹å¼ç¯„ä¾‹ï¼š**

```javascript
fetch("http://localhost:8080/ch2_3/api/todo/1")
  .then((response) => {
    // Fetch ä¸æœƒè‡ªå‹•éæ¿¾ 4xx, 5xx éŒ¯èª¤ï¼Œéœ€æ‰‹å‹•åˆ¤æ–·
    if (!response.ok) {
      throw new Error("ç¶²è·¯å›æ‡‰ä¸æ­£å¸¸");
    }
    return response.json(); // éœ€æ‰‹å‹•è½‰ç‚º JSON
  })
  .then((data) => console.log(data))
  .catch((error) => console.error("ç™¼ç”ŸéŒ¯èª¤:", error));
```

### é¸æ‰‹ 3: Axios

ç›®å‰æ¥­ç•Œæœ€å»£æ³›ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ HTTP Client å‡½å¼åº«ã€‚

- **å„ªé»**ï¼š
  - **è‡ªå‹•è½‰æ› JSON**ï¼šå–å¾—çš„è³‡æ–™æœƒè‡ªå‹•è½‰ç‚º JavaScript Objectã€‚
  - **åˆç†çš„éŒ¯èª¤è™•ç†**ï¼šåªè¦ Status Code ä¸æ˜¯ 2xxï¼Œå°±æœƒè‡ªå‹•æ‹‹å‡ºéŒ¯èª¤é€²å…¥ `catch`ã€‚
  - **åŠŸèƒ½å¼·å¤§**ï¼šæ”¯æ´æ””æˆªå™¨ (Interceptors)ã€è«‹æ±‚å–æ¶ˆã€ä¸Šå‚³é€²åº¦ç›£è½ç­‰ã€‚
  - **èªæ³•ç°¡æ½”**ï¼šæ”¯æ´ Promise èˆ‡ Async/Awaitã€‚

**ç¨‹å¼ç¯„ä¾‹ï¼š**

```javascript
// ç™¼é€ GET è«‹æ±‚ (æŸ¥è©¢è³‡æ–™)
axios
  .get("http://localhost:8080/ch2_3/api/todo", {
    // params: { userId: 1 }, // (é¸å¡«) Axios æœƒè‡ªå‹•å¹«ä½ æŠŠåƒæ•¸ä¸²åœ¨ç¶²å€å¾Œé¢
  })
  .then((response) => {
    // Axios å›å‚³çš„ response ç‰©ä»¶åŒ…å«è±å¯Œè³‡è¨Šï¼š
    console.log("Status Code:", response.status); // ç‹€æ…‹ç¢¼ (ex: 200)
    console.log("Headers:", response.headers); // å›æ‡‰æ¨™é ­
    console.log("Data:", response.data); // ä¼ºæœå™¨å›å‚³çš„è³‡æ–™ (å·²è‡ªå‹•è½‰ç‚º JSON ç‰©ä»¶)
  })
  .catch((error) => {
    // åªè¦æ˜¯ 4xx æˆ– 5xx çš„éŒ¯èª¤éƒ½æœƒé€²åˆ°é€™è£¡
    console.error("è«‹æ±‚å¤±æ•—:", error);
  });
```

#### Axios å¯¦ä¾‹åŒ–ç¯„ä¾‹

åœ¨å¯¦å‹™é–‹ç™¼ä¸­ï¼Œç‚ºäº†æ–¹ä¾¿ç®¡ç†èˆ‡ç¶­è­·ï¼Œæˆ‘å€‘é€šå¸¸æœƒå°‡ Axios å°è£æˆä¸€å€‹ç¨ç«‹çš„æª”æ¡ˆ (`apiClient.js`)ï¼Œä¸¦åœ¨æ­¤çµ±ä¸€è™•ç†ã€Œè«‹æ±‚è¨­å®šã€èˆ‡ã€ŒéŒ¯èª¤æ””æˆªã€ã€‚

**1. å»ºç«‹ç¨ç«‹çš„ API Client (`api/apiClient.js`)**

```javascript
import axios from "axios";

const apiClient = axios.create({
  baseURL: "http://localhost:8080/ch2_3/api",
  timeout: 5000, // 5ç§’æ²’å›æ‡‰å°±å ±éŒ¯
  headers: { "Content-Type": "application/json" },
});

// è«‹æ±‚æ””æˆªå™¨ï¼šæ¯æ¬¡ç™¼é€å‰è‡ªå‹•åŸ·è¡Œ
apiClient.interceptors.request.use(
  (config) => {
    // ä¾‹å¦‚ï¼šå¾ localStorage å–å‡º token æ”¾å…¥ header
    const token = localStorage.getItem("token");
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  // è«‹æ±‚ç™¼é€å‰çš„éŒ¯èª¤è™•ç†
  (error) => Promise.reject(error)
);

// å›æ‡‰æ””æˆªå™¨ï¼šæ¥æ”¶åˆ°å›æ‡‰å¾Œè‡ªå‹•åŸ·è¡Œ
apiClient.interceptors.response.use(
  (response) => {
    // æ¥æ”¶åˆ°å›æ‡‰å¾Œï¼Œå¯é€²è¡Œå›æ‡‰çš„é è™•ç†ï¼Œå¦‚
    // 1: ç°¡åŒ–è³‡æ–™å±¤ç´šï¼Œç›´æ¥å›å‚³ dataï¼Œé€™æ¨£å‰ç«¯å‘¼å«æ™‚å°±ä¸ç”¨å¤šå¯«ä¸€å±¤ .data
    // 2: å¯ä»¥åœ¨é€™è£¡é€²è¡Œå…¨åŸŸçš„ Log ç´€éŒ„æˆ–æ•¸æ“šçµ±è¨ˆ
    return response.data;
  },
  (error) => {
    // çµ±ä¸€è™•ç† HTTP éŒ¯èª¤ç‹€æ…‹ç¢¼
    if (error.response) {
      switch (error.response.status) {
        case 401:
          console.error("æœªæˆæ¬Šï¼Œè«‹é‡æ–°ç™»å…¥");
          // ä¾‹å¦‚ï¼šå°å‘ç™»å…¥é 
          // window.location.href = '/login.html';
          break;
        case 403:
          console.error("æ¬Šé™ä¸è¶³");
          break;
        case 404:
          console.error("æ‰¾ä¸åˆ°è³‡æº");
          break;
        case 500:
          console.error("ä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤");
          break;
        default:
          console.error("ç™¼ç”Ÿå…¶ä»–éŒ¯èª¤");
      }
    }
    // å°‡æœªæ•æ‰åˆ°çš„éŒ¯èª¤ç¹¼çºŒå¾€å¤–å‚³é
    return Promise.reject(error);
  }
);

export default apiClient;
```

**2. åœ¨ä¸»ç¨‹å¼ä¸­ä½¿ç”¨ (`index.js`)**

```javascript
import apiClient from "./api/apiClient.js";

const getUser = async () => {
  try {
    // ç¨‹å¼ç¢¼è®Šå¾—éå¸¸ä¹¾æ·¨ï¼Œä¸ç”¨é‡è¤‡å¯«ç¶²å€æˆ–è™•ç†é€šç”¨éŒ¯èª¤
    const res = await apiClient.get("/todo");
    console.log(res); // æ””æˆªå™¨å·²é è™•ç†ï¼Œç›´æ¥å›å‚³ response.data (å³ List<Todo>)
  } catch (err) {
    // é€™è£¡åªéœ€è¦è™•ç†ã€Œç‰¹å®šæ¥­å‹™é‚è¼¯ã€çš„éŒ¯èª¤ï¼Œé€šç”¨çš„éŒ¯èª¤å·²è¢«æ””æˆªå™¨è™•ç†æ‰äº†
    console.error("å–å¾—å¾…è¾¦äº‹é …å¤±æ•—:", err);
  }
};
```

å¾ä¸‹ä¸€ç« é–‹å§‹ï¼Œæˆ‘å€‘å°‡å…¨é¢ä½¿ç”¨ **Axios** (é…åˆ CDN å¼•å…¥) ä¾†é€²è¡Œé–‹ç™¼ã€‚
